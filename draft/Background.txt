
Background

Polyploids are those organisms that own more than two copies of their chromosomes sets. Economically important crops such as potato, wheat, apple and banana are polyploids. For an efficient crop breeding which ensures particular phenotypic traits, haplotype, the sequence of alleles at variant sites corresponds to each chromosome, is needed (Qian 2017). With thanks to the DNA sequencing technology alongside computational tools, reconstructing the haplotypes a.k.a single individual haplotyping becomes feasible as a substitute of previous high-cost wet-lab experiments although obtaining prefect haplotypes is still challenging for polyploids (Motazedi 2017).

DNA sequencing technologies can be divided into two major categories based on the read length. 1) short read sequencing pioneered by Illumina 2) long read sequencing developed by Pacific Biosciences and Oxford Nanopore (Goodwin 2016). However, the attained long reads provided by the latter is favorable for obtaining a longer haplotype, its expansive usage is hindered by their high costs and high error rates compared to the Illumina sequencing. 

Recently, 10X Genomics introduced linked-read concept provided by their Chromium platform as a complement technology to Illumina devices which paves the way for reaching low-cost long fragments with low error rate. In their library preparation techniques, the input genomic DNA (as small as 1ng) is sheared into molecules with the size of ~10-100 Kbp. Then the Chromium partitions and barcodes DNA molecules using microfluidics which is followed by the Illumina paired-end sequencing (Weisenfeld et al., 2017).

The haplotyping problem is NP-Hard. In recent years, several algorithms for polyploid haplotyping, namely SDhaP (Das 2015), H-PoP (Xie 2016) and cMFR (Siragusa2019), have been developed for Illumina datasets. But there is not any polyploid haplotyping algorithm for linked-read data to the best of our knowledge.

Here, we have developed the first haplotyping algorithm designed for 10x linked-reads generated from a polyploid genome. We provide a general framework that paves the way for haplotyping of 10x linked-reads built on a typical Illumina haplotyping algorithm with input format of the standard fragment file.  Thus, any improvement in such algorithms may enhance our methods for 10x haplotyping. The existing Illumina haplotyping algorithm is not able to handle 10x data generated from a medium-size polyploid genome (> 50 Mbp). The proposed pre-processing makes feasible the haplotyping of chromosome scale of such genomes. We also proposed a novel optimization providing more accurate haplotypes with comparable block length.




Methods
The output of illumina device is two fastq files corresponding to two parts of paired-end reads. 
16 bp of the first part are the barcodes. Using Longranger provided by 10x Genomics, is used for extracting barcodes and doing barcode error correction and aligning the reads. The output will be a bam file in which the barcodes are in BX tag.

Then, using freebayes the single-nucleotide variants (SNV) are called. Since the heterozygous SNVs are important for haplotyping, we filtered out the homozygous variants. Then using bampocess.py, we extract the alleles of the SNV position from the reads in bam file. 
Then, we combine those reads with the same barcodes. Then we have a fragment file which seems to be a standard form used for haplotyping mostly for diploids. 


A problem which arises here is that it is assumed that each line of fragment file should came from one haplotype.

Recall that those reads from molecules in the bead have the same barcode.
Unfortunately, in each bead there are 10 molecules on average which originates from one of the haploid chromosome randomly.

these are far from each other,
here we proposed a mean shift clustering approach in order to cluster parts of fragment 
to several molecule specific fragments (mcf)
















Aguiar and Istrail (2013) defined an NP-hard problem named minimum weighted edge removal in a compass graph and employed a minimum-cost spanning tree heuristic to solve it.  Berger et al. (2014) defined a probabilistic framework and used heuristic branch-and-bound to find likely haplotypes given the fragments. Das and Vikalo (2015) casted the problem as a correlation clustering problem and derived approximate solutions to the associated semidefinite program via Lagrangian relaxation followed by randomized projections and greedy refinement.  Xie et al. (2016) defined a NP-hard problem called polyploid balanced optimal partition and proposed constrained dynamic programming to find heuristic solutions.  Mazrouee and Wang (2018) proposed a clustering approach to minimize disagreement among fragments.



not only accurate but also scalable.
The fundamental limitations in * are the fact that the

In order to tackle the problem
Within each GEM, there are, on average, 10 gDNA molecules. 
16 bp molecular barcode that is unique to each droplet.


Reference

Qian 2017 Exploring and Harnessing Haplotype Diversity to Improve Yield Stability in Crops
Sara Goodwin, John D McPherson, and W Richard McCombie. Coming of age: ten years of next- generation sequencing technologies. Nature Reviews Genetics, 17(6):333â€“351, 2016.
Motazedi, Exploiting next-generation sequencing to solve the haplotyping puzzle in polyploids: a simulation study

Weisenfeld 2017, Direct determination of diploid genome sequences

Das 2015, SDhaP haplotype assembly for diploids and polyploids via semi-definite programming

Xie 2016, H-PoP and H-PoPG- heuristic partitioning algorithms for single individual haplotyping of polyploids

Siragusa 2019, Haplotype assembly of autotetraploid potato using integer linear programing


 sequence alignment format 